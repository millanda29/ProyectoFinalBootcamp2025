{
  "apiDocumentation": {
    "baseUrl": "http://localhost:4000/api",
    "version": "1.0.0",
    "description": "TravelMate API - Sistema completo de planificación de viajes con IA",
    "authentication": {
      "type": "Bearer Token",
      "header": "Authorization: Bearer <token>",
      "note": "Incluir token JWT en el header Authorization para rutas protegidas"
    },
    "lastUpdated": "2025-09-06T22:00:00.000Z"
  },
  "endpoints": {
    "auth": {
      "baseRoute": "/api/auth",
      "description": "Autenticación y gestión de sesiones",
      "endpoints": {
        "register": {
          "method": "POST",
          "path": "/api/auth/register",
          "description": "Registrar nuevo usuario",
          "authentication": false,
          "request": {
            "headers": {
              "Content-Type": "application/json"
            },
            "body": {
              "email": "usuario@example.com",
              "password": "password123",
              "fullName": "Juan Pérez"
            }
          },
          "response": {
            "success": {
              "status": 201,
              "body": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
              }
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "El usuario ya existe."
              }
            }
          }
        },
        "login": {
          "method": "POST",
          "path": "/api/auth/login",
          "description": "Iniciar sesión de usuario",
          "authentication": false,
          "request": {
            "headers": {
              "Content-Type": "application/json"
            },
            "body": {
              "email": "usuario@example.com",
              "password": "password123"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
              }
            },
            "error": {
              "status": 401,
              "body": {
                "success": false,
                "message": "Credenciales inválidas"
              }
            }
          }
        },
        "refresh": {
          "method": "POST",
          "path": "/api/auth/refresh",
          "description": "Renovar token de acceso",
          "authentication": false,
          "request": {
            "headers": {
              "Content-Type": "application/json"
            },
            "body": {
              "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
              }
            }
          }
        },
        "logout": {
          "method": "POST",
          "path": "/api/auth/logout",
          "description": "Cerrar sesión y invalidar refresh token",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Sesión cerrada exitosamente"
              }
            }
          }
        },
        "changePasswordAuth": {
          "method": "PUT",
          "path": "/api/auth/change-password",
          "description": "Cambiar contraseña del usuario autenticado",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "currentPassword": "password123",
              "newPassword": "newPassword456"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Contraseña actualizada exitosamente"
              }
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "La contraseña actual es incorrecta"
              }
            }
          }
        }
      }
    },
    "users": {
      "baseRoute": "/api/users",
      "description": "Gestión de usuarios y perfiles",
      "endpoints": {
        "getProfile": {
          "method": "GET",
          "path": "/api/users/me",
          "description": "Obtener perfil del usuario autenticado",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c36",
                  "email": "usuario@example.com",
                  "fullName": "Juan Pérez",
                  "avatarUrl": "https://example.com/avatar.jpg",
                  "bio": "Amante de los viajes",
                  "role": "traveler",
                  "preferences": {
                    "currency": "USD",
                    "language": "es",
                    "notifications": true
                  },
                  "travelPreferences": {
                    "preferredCurrency": "USD",
                    "preferredLanguage": "es",
                    "budgetRange": "medium",
                    "travelStyle": "adventure",
                    "accommodationType": "hotel"
                  },
                  "memberSince": "2025-01-15T00:00:00.000Z",
                  "createdAt": "2025-01-15T10:30:00.000Z",
                  "updatedAt": "2025-09-05T12:00:00.000Z"
                }
              }
            }
          }
        },
        "updateProfile": {
          "method": "PUT",
          "path": "/api/users/me",
          "description": "Actualizar perfil del usuario",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "fullName": "Juan Carlos Pérez",
              "bio": "Explorador del mundo",
              "avatarUrl": "https://example.com/new-avatar.jpg",
              "preferences": {
                "currency": "EUR",
                "language": "en",
                "notifications": false
              },
              "travelPreferences": {
                "preferredCurrency": "EUR",
                "preferredLanguage": "en",
                "budgetRange": "luxury",
                "travelStyle": "relaxation",
                "accommodationType": "resort"
              }
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c36",
                  "email": "usuario@example.com",
                  "fullName": "Juan Carlos Pérez",
                  "bio": "Explorador del mundo",
                  "avatarUrl": "https://example.com/new-avatar.jpg"
                },
                "message": "Perfil actualizado exitosamente"
              }
            }
          }
        },
        "deleteAccount": {
          "method": "DELETE",
          "path": "/api/users/me",
          "description": "Eliminar cuenta de usuario (eliminación lógica)",
          "authentication": true,
          "note": "Ahora utiliza eliminación lógica en lugar de física",
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "password": "password123"
            }
          },
          "response": {
            "success": {
              "status": 204,
              "body": null
            }
          }
        },
        "getUserTrips": {
          "method": "GET",
          "path": "/api/users/me/trips",
          "description": "Obtener todos los viajes del usuario",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "query": {
              "page": "1",
              "limit": "10",
              "status": "planned|active|completed|cancelled"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b64f17f1a0cf46346a444c",
                    "title": "Viaje a París",
                    "destination": "París, Francia",
                    "startDate": "2025-10-15T00:00:00.000Z",
                    "endDate": "2025-10-22T00:00:00.000Z",
                    "status": "planned",
                    "totalBudget": 2500
                  }
                ],
                "pagination": {
                  "currentPage": 1,
                  "totalPages": 1,
                  "totalTrips": 1,
                  "hasNext": false,
                  "hasPrev": false
                }
              }
            }
          }
        },
        "getAllUsers": {
          "method": "GET",
          "path": "/api/users/admin/all",
          "description": "Obtener todos los usuarios (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "query": {
              "page": "1",
              "limit": "10",
              "search": "texto de búsqueda"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b9beef3aa2d4cd89785c36",
                    "email": "usuario@example.com",
                    "fullName": "Juan Pérez",
                    "roles": ["traveler"],
                    "isActive": true,
                    "createdAt": "2025-01-15T00:00:00.000Z"
                  }
                ],
                "pagination": {
                  "currentPage": 1,
                  "totalPages": 5,
                  "totalUsers": 47,
                  "hasNext": true,
                  "hasPrev": false
                }
              }
            }
          }
        },
        "getFullProfile": {
          "method": "GET",
          "path": "/api/users/me/full",
          "description": "Obtener perfil completo con estadísticas",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c36",
                  "email": "usuario@example.com",
                  "fullName": "Juan Pérez",
                  "travelPreferences": {
                    "preferredCurrency": "USD",
                    "preferredLanguage": "es",
                    "travelStyle": "adventure"
                  },
                  "stats": {
                    "tripsCompleted": 5,
                    "countriesVisited": ["España", "Francia", "Japón"],
                    "totalSpent": 15000,
                    "totalSaved": 2500
                  }
                }
              }
            }
          }
        },
        "updateTravelPreferences": {
          "method": "PUT",
          "path": "/api/users/me/preferences",
          "description": "Actualizar preferencias de viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "preferredCurrency": "EUR",
              "preferredLanguage": "en",
              "travelStyle": "luxury",
              "accommodationPreference": "hotel"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "preferredCurrency": "EUR",
                  "preferredLanguage": "en",
                  "travelStyle": "luxury"
                },
                "message": "Preferencias de viaje actualizadas correctamente"
              }
            }
          }
        },
        "updateNotifications": {
          "method": "PUT",
          "path": "/api/users/me/notifications",
          "description": "Actualizar configuración de notificaciones",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "email": true,
              "push": false,
              "tripReminders": true,
              "promotions": false
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "email": true,
                  "push": false,
                  "tripReminders": true,
                  "promotions": false
                },
                "message": "Configuración de notificaciones actualizada correctamente"
              }
            }
          }
        },
        "updateStats": {
          "method": "PUT",
          "path": "/api/users/me/stats",
          "description": "Actualizar estadísticas de usuario",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "tripCost": 1500,
              "country": "Italia"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "tripsCompleted": 6,
                  "countriesVisited": ["España", "Francia", "Japón", "Italia"],
                  "totalSpent": 16500
                },
                "message": "Estadísticas actualizadas correctamente"
              }
            }
          }
        },
        "findSimilarUsers": {
          "method": "GET",
          "path": "/api/users/similar",
          "description": "Buscar usuarios con preferencias similares",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "query": {
              "travelStyle": "adventure",
              "preferredCurrency": "USD"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b9beef3aa2d4cd89785c37",
                    "fullName": "María García",
                    "location": "Barcelona, España",
                    "travelStyle": "adventure",
                    "similarityScore": 0.85
                  }
                ],
                "count": 1
              }
            }
          }
        },
        "createUser": {
          "method": "POST",
          "path": "/api/users/admin/create",
          "description": "Crear nuevo usuario (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>",
              "Content-Type": "application/json"
            },
            "body": {
              "email": "nuevo@example.com",
              "password": "password123",
              "fullName": "Usuario Nuevo",
              "roles": ["traveler"]
            }
          },
          "response": {
            "success": {
              "status": 201,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c99",
                  "email": "nuevo@example.com",
                  "fullName": "Usuario Nuevo",
                  "roles": ["traveler"]
                },
                "message": "Usuario creado correctamente"
              }
            }
          }
        },
        "getUserById": {
          "method": "GET",
          "path": "/api/users/admin/:id",
          "description": "Obtener usuario por ID (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b9beef3aa2d4cd89785c36"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c36",
                  "email": "usuario@example.com",
                  "fullName": "Juan Pérez",
                  "roles": ["traveler"],
                  "isActive": true
                }
              }
            }
          }
        },
        "updateUser": {
          "method": "PUT",
          "path": "/api/users/admin/:id",
          "description": "Actualizar usuario (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>",
              "Content-Type": "application/json"
            },
            "params": {
              "id": "68b9beef3aa2d4cd89785c36"
            },
            "body": {
              "fullName": "Juan Pérez Actualizado",
              "roles": ["traveler", "premium"],
              "isActive": false
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b9beef3aa2d4cd89785c36",
                  "fullName": "Juan Pérez Actualizado",
                  "roles": ["traveler", "premium"]
                },
                "message": "Usuario actualizado correctamente"
              }
            }
          }
        },
        "deleteUser": {
          "method": "DELETE",
          "path": "/api/users/admin/:id",
          "description": "Eliminar usuario (eliminación lógica, solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b9beef3aa2d4cd89785c36"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Usuario y sus viajes marcados como eliminados correctamente."
              }
            }
          }
        },
        "resetPassword": {
          "method": "PUT",
          "path": "/api/users/admin/:id/reset-password",
          "description": "Resetear contraseña de usuario (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>",
              "Content-Type": "application/json"
            },
            "params": {
              "id": "68b9beef3aa2d4cd89785c36"
            },
            "body": {
              "newPassword": "nuevaPassword123"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Contraseña reseteada correctamente."
              }
            }
          }
        },
        "getStats": {
          "method": "GET",
          "path": "/api/users/admin/stats",
          "description": "Obtener estadísticas de usuarios (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "totalUsers": 47,
                  "activeUsers": 42,
                  "newUsersThisMonth": 8,
                  "usersByRole": {
                    "traveler": 45,
                    "admin": 2
                  }
                }
              }
            }
          }
        },
        "changePassword": {
          "method": "PUT",
          "path": "/api/users/me/change-password",
          "description": "Cambiar contraseña del usuario",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "currentPassword": "password123",
              "newPassword": "newPassword456",
              "confirmPassword": "newPassword456"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Contraseña actualizada exitosamente"
              }
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "La contraseña actual es incorrecta"
              }
            }
          }
        },
        "scheduleAccountDeletion": {
          "method": "POST",
          "path": "/api/users/me/schedule-deletion",
          "description": "Programar eliminación de cuenta (31 días)",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "reason": "Ya no uso la aplicación"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "scheduledDate": "2025-10-06T16:00:00.000Z",
                  "daysRemaining": 31
                },
                "message": "Eliminación de cuenta programada para el 6 de octubre de 2025"
              }
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "Ya hay una eliminación programada para esta cuenta"
              }
            }
          }
        },
        "cancelAccountDeletion": {
          "method": "DELETE",
          "path": "/api/users/me/cancel-deletion",
          "description": "Cancelar eliminación programada de la cuenta",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Eliminación de cuenta cancelada exitosamente"
              }
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "No hay ninguna eliminación programada para esta cuenta"
              }
            }
          }
        },
        "deleteAccountImmediate": {
          "method": "DELETE",
          "path": "/api/users/me",
          "description": "Eliminar cuenta inmediatamente (eliminación lógica)",
          "authentication": true,
          "note": "Ahora utiliza eliminación lógica en lugar de física",
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "password": "password123"
            }
          },
          "response": {
            "success": {
              "status": 204,
              "body": null
            },
            "error": {
              "status": 400,
              "body": {
                "success": false,
                "message": "Contraseña incorrecta"
              }
            }
          }
        },
        "getDeletedUsers": {
          "method": "GET",
          "path": "/api/users/admin/deleted",
          "description": "Obtener usuarios eliminados (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b64f17f1a0cf46346a444c",
                    "email": "usuario@example.com",
                    "fullName": "Usuario Eliminado",
                    "isDeleted": true,
                    "deletedAt": "2025-09-05T10:30:00.000Z",
                    "deletedBy": "68b64f17f1a0cf46346a555d"
                  }
                ],
                "count": 1
              }
            }
          }
        },
        "restoreUser": {
          "method": "POST",
          "path": "/api/users/admin/:id/restore",
          "description": "Restaurar usuario eliminado (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "email": "usuario@example.com",
                  "fullName": "Usuario Restaurado",
                  "isDeleted": false
                },
                "message": "Usuario restaurado correctamente."
              }
            }
          }
        },
        "permanentlyDeleteUser": {
          "method": "DELETE",
          "path": "/api/users/admin/:id/permanent",
          "description": "Eliminar usuario permanentemente (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Usuario eliminado permanentemente."
              }
            }
          }
        }
      }
    },
    "trips": {
      "baseRoute": "/api/trips",
      "description": "Gestión completa de viajes",
      "endpoints": {
        "getMyTrips": {
          "method": "GET",
          "path": "/api/trips/my",
          "description": "Obtener mis viajes con paginación",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "query": {
              "page": "1",
              "limit": "5",
              "status": "planned|active|completed|cancelled"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b64f17f1a0cf46346a444c",
                    "title": "Aventura en Tokio",
                    "destination": "Tokio, Japón",
                    "startDate": "2025-11-01T00:00:00.000Z",
                    "endDate": "2025-11-15T00:00:00.000Z",
                    "partySize": 2,
                    "status": "planned",
                    "totalBudget": 3500,
                    "itinerary": [],
                    "costs": [],
                    "reports": [],
                    "createdAt": "2025-09-01T00:00:00.000Z",
                    "updatedAt": "2025-09-05T00:00:00.000Z"
                  }
                ],
                "pagination": {
                  "currentPage": 1,
                  "totalPages": 3,
                  "totalTrips": 12,
                  "hasNext": true,
                  "hasPrev": false
                }
              }
            }
          }
        },
        "createTrip": {
          "method": "POST",
          "path": "/api/trips",
          "description": "Crear nuevo viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "title": "Aventura en Patagonia",
              "destination": "Patagonia, Argentina",
              "startDate": "2025-12-01",
              "endDate": "2025-12-15",
              "partySize": 4,
              "description": "Trekking y aventura en la Patagonia"
            }
          },
          "response": {
            "success": {
              "status": 201,
              "body": {
                "success": true,
                "data": {
                  "id": "68baf123e3ad478f65bacf5d",
                  "title": "Aventura en Patagonia",
                  "destination": "Patagonia, Argentina",
                  "startDate": "2025-12-01T00:00:00.000Z",
                  "endDate": "2025-12-15T00:00:00.000Z",
                  "partySize": 4,
                  "status": "planned"
                },
                "message": "Viaje creado exitosamente"
              }
            }
          }
        },
        "getTripById": {
          "method": "GET",
          "path": "/api/trips/:id",
          "description": "Obtener detalles de un viaje específico",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "userId": "68b9beef3aa2d4cd89785c36",
                  "title": "Aventura en Tokio",
                  "destination": "Tokio, Japón",
                  "startDate": "2025-11-01T00:00:00.000Z",
                  "endDate": "2025-11-15T00:00:00.000Z",
                  "partySize": 2,
                  "status": "planned",
                  "description": "Exploración cultural y gastronómica",
                  "itinerary": [],
                  "costs": [],
                  "aiConversations": [],
                  "reports": [],
                  "totalBudget": 0
                }
              }
            }
          }
        },
        "updateTrip": {
          "method": "PUT",
          "path": "/api/trips/:id",
          "description": "Actualizar información del viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            },
            "body": {
              "title": "Gran Aventura en Tokio",
              "description": "Experiencia completa en Japón",
              "status": "active"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "title": "Gran Aventura en Tokio",
                  "description": "Experiencia completa en Japón",
                  "status": "active"
                },
                "message": "Viaje actualizado exitosamente"
              }
            }
          }
        },
        "deleteTrip": {
          "method": "DELETE",
          "path": "/api/trips/:id",
          "description": "Eliminar viaje (eliminación lógica)",
          "authentication": true,
          "note": "Ahora utiliza eliminación lógica en lugar de física. Los PDFs se mantienen para posible restauración.",
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 204,
              "body": null
            }
          }
        },
        "addCosts": {
          "method": "PUT",
          "path": "/api/trips/:id/costs",
          "description": "Agregar costos al viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            },
            "body": {
              "costs": [
                {
                  "type": "accommodation",
                  "label": "Hotel por noche",
                  "currency": "USD",
                  "amount": 150,
                  "quantity": 14
                },
                {
                  "type": "food",
                  "label": "Comidas diarias",
                  "currency": "USD",
                  "amount": 80,
                  "quantity": 14
                }
              ]
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "totalBudget": 3220,
                  "costs": [
                    {
                      "type": "accommodation",
                      "label": "Hotel por noche",
                      "currency": "USD",
                      "amount": 150,
                      "quantity": 14
                    }
                  ]
                },
                "message": "Costos agregados exitosamente"
              }
            }
          }
        },
        "updateItinerary": {
          "method": "PUT",
          "path": "/api/trips/:id/itinerary",
          "description": "Actualizar itinerario del viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            },
            "body": {
              "itinerary": [
                {
                  "dayNumber": 1,
                  "notes": "Primer día en Tokio",
                  "activities": [
                    {
                      "time": "09:00",
                      "activity": "Desayuno en el hotel",
                      "location": "Hotel Shibuya"
                    },
                    {
                      "time": "10:30",
                      "activity": "Visita al Templo Senso-ji",
                      "location": "Asakusa"
                    }
                  ]
                }
              ]
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "itinerary": [
                    {
                      "dayNumber": 1,
                      "notes": "Primer día en Tokio",
                      "activities": [
                        {
                          "time": "09:00",
                          "activity": "Desayuno en el hotel",
                          "location": "Hotel Shibuya"
                        }
                      ]
                    }
                  ]
                },
                "message": "Itinerario actualizado exitosamente"
              }
            }
          }
        },
        "generateReport": {
          "method": "POST",
          "path": "/api/trips/:id/report",
          "description": "Generar reporte PDF del viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "downloadUrl": "/reports/trip-68b64f17f1a0cf46346a444c-1757080360529.pdf",
                  "fileName": "trip-68b64f17f1a0cf46346a444c-1757080360529.pdf",
                  "generatedAt": "2025-09-05T15:32:40.529Z"
                },
                "message": "Reporte PDF generado exitosamente"
              }
            }
          }
        },
        "getTripReports": {
          "method": "GET",
          "path": "/api/trips/:id/reports",
          "description": "Obtener lista de reportes del viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "fileUrl": "/reports/trip-68b64f17f1a0cf46346a444c-1757080360529.pdf",
                    "format": "pdf",
                    "generatedAt": "2025-09-05T15:32:40.529Z"
                  }
                ]
              }
            }
          }
        },
        "servePDF": {
          "method": "GET",
          "path": "/api/trips/:id/pdf",
          "description": "Descargar PDF del viaje",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "headers": {
                "Content-Type": "application/pdf",
                "Content-Disposition": "attachment; filename=\"trip-report.pdf\""
              },
              "body": "Binary PDF content"
            }
          }
        },
        "getAllTrips": {
          "method": "GET",
          "path": "/api/trips",
          "description": "Obtener todos los viajes (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "query": {
              "page": "1",
              "limit": "10",
              "status": "planned|active|completed|cancelled"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b64f17f1a0cf46346a444c",
                    "userId": "68b9beef3aa2d4cd89785c36",
                    "title": "Aventura en Tokio",
                    "destination": "Tokio, Japón",
                    "status": "planned",
                    "totalBudget": 3500,
                    "createdAt": "2025-09-01T00:00:00.000Z"
                  }
                ],
                "pagination": {
                  "currentPage": 1,
                  "totalPages": 15,
                  "totalTrips": 142,
                  "hasNext": true,
                  "hasPrev": false
                }
              }
            }
          }
        },
        "cleanupOrphanedPDFs": {
          "method": "DELETE",
          "path": "/api/trips/cleanup/orphaned-pdfs",
          "description": "Limpiar archivos PDF huérfanos (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Limpieza completada. 3 archivos PDF huérfanos eliminados.",
                "deletedFiles": 3
              }
            }
          }
        },
        "getDeletedTrips": {
          "method": "GET",
          "path": "/api/trips/deleted",
          "description": "Obtener viajes eliminados (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": [
                  {
                    "id": "68b64f17f1a0cf46346a444c",
                    "userId": "68b9beef3aa2d4cd89785c36",
                    "title": "Aventura Eliminada",
                    "destination": "Tokio, Japón",
                    "isDeleted": true,
                    "deletedAt": "2025-09-05T10:30:00.000Z",
                    "deletedBy": "68b64f17f1a0cf46346a555d"
                  }
                ],
                "count": 1
              }
            }
          }
        },
        "restoreTrip": {
          "method": "POST",
          "path": "/api/trips/:id/restore",
          "description": "Restaurar viaje eliminado (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "id": "68b64f17f1a0cf46346a444c",
                  "title": "Aventura Restaurada",
                  "destination": "Tokio, Japón",
                  "isDeleted": false
                },
                "message": "Trip restored successfully"
              }
            }
          }
        },
        "permanentlyDeleteTrip": {
          "method": "DELETE",
          "path": "/api/trips/:id/permanent",
          "description": "Eliminar viaje permanentemente (solo admin)",
          "authentication": true,
          "adminOnly": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <admin_token>"
            },
            "params": {
              "id": "68b64f17f1a0cf46346a444c"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "message": "Trip permanently deleted"
              }
            }
          }
        }
      }
    },
    "chat": {
      "baseRoute": "/api/chat",
      "description": "Asistente de IA para planificación de viajes",
      "endpoints": {
        "generateItinerary": {
          "method": "POST",
          "path": "/api/chat/itinerary",
          "description": "Generar itinerario de viaje con IA",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "destination": "Kyoto, Japón",
              "startDate": "2025-11-01",
              "endDate": "2025-11-07",
              "partySize": 2,
              "budget": 2000,
              "interests": ["cultura", "gastronomía", "templos"],
              "travelStyle": "cultural"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "title": "Aventura Cultural en Kyoto",
                  "destination": "Kyoto, Japón",
                  "duration": "7 días",
                  "estimatedBudget": 1850,
                  "itinerary": [
                    {
                      "dayNumber": 1,
                      "notes": "Llegada y primera exploración",
                      "activities": [
                        {
                          "time": "09:00",
                          "activity": "Llegada al aeropuerto de Kansai",
                          "location": "Aeropuerto Kansai"
                        }
                      ]
                    }
                  ],
                  "costs": [
                    {
                      "type": "accommodation",
                      "label": "Ryokan tradicional por noche",
                      "currency": "USD",
                      "amount": 150,
                      "quantity": 6
                    }
                  ],
                  "recommendations": [
                    "Visitar el Templo Fushimi Inari al amanecer",
                    "Probar kaiseki en el distrito de Pontocho"
                  ]
                },
                "message": "Itinerario generado exitosamente"
              }
            }
          }
        },
        "generateTripItinerary": {
          "method": "POST",
          "path": "/api/chat/trip/:tripId/itinerary",
          "description": "Generar itinerario para un viaje específico",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "params": {
              "tripId": "68b64f17f1a0cf46346a444c"
            },
            "body": {
              "interests": ["historia", "naturaleza"],
              "budget": 1500,
              "travelStyle": "cultural"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "tripId": "68b64f17f1a0cf46346a444c",
                  "itinerary": [
                    {
                      "dayNumber": 1,
                      "notes": "Día de llegada",
                      "activities": [
                        {
                          "time": "10:00",
                          "activity": "Check-in al hotel",
                          "location": "Hotel centro"
                        }
                      ]
                    }
                  ],
                  "estimatedCosts": [
                    {
                      "type": "accommodation",
                      "amount": 100,
                      "currency": "USD"
                    }
                  ]
                },
                "message": "Itinerario generado para el viaje"
              }
            }
          }
        },
        "chatAssistant": {
          "method": "POST",
          "path": "/api/chat/assistant",
          "description": "Chat con asistente de viajes",
          "authentication": true,
          "request": {
            "headers": {
              "Authorization": "Bearer <token>",
              "Content-Type": "application/json"
            },
            "body": {
              "message": "¿Cuál es la mejor época para visitar Machu Picchu?",
              "tripId": "68b64f17f1a0cf46346a444c",
              "context": "Estoy planificando un viaje a Perú para mi luna de miel"
            }
          },
          "response": {
            "success": {
              "status": 200,
              "body": {
                "success": true,
                "data": {
                  "response": "La mejor época para visitar Machu Picchu es durante la estación seca, de mayo a septiembre...",
                  "conversationId": "conv_68b64f17f1a0cf46346a444c_1757082000",
                  "timestamp": "2025-09-05T16:00:00.000Z"
                },
                "message": "Respuesta generada exitosamente"
              }
            }
          }
        }
      }
    }
  },
  "dataModels": {
    "User": {
      "description": "Modelo de usuario del sistema",
      "fields": {
        "id": "string - ID único del usuario",
        "email": "string - Email único",
        "fullName": "string - Nombre completo",
        "passwordHash": "string - Hash de la contraseña (no devuelto en respuestas)",
        "phone": "string - Teléfono (opcional)",
        "location": "string - Ciudad, País (opcional)",
        "bio": "string - Biografía (opcional, máx 500 chars)",
        "website": "string - URL del sitio web (opcional)",
        "avatarUrl": "string - URL del avatar",
        "roles": "Array[string] - Roles del usuario (default: ['traveler'])",
        "isActive": "boolean - Usuario activo",
        "lastLogin": "Date - Última fecha de login",
        "loginAttempts": "number - Intentos de login fallidos",
        "travelPreferences": {
          "preferredCurrency": "string - Moneda preferida (USD, EUR, etc.)",
          "preferredLanguage": "string - Idioma preferido (en, es, fr, etc.)",
          "travelStyle": "string - Estilo de viaje (budget, balanced, luxury, adventure, cultural, relaxation, business)",
          "favoriteDestination": "string - Destino favorito",
          "budgetRange": {
            "min": "number - Presupuesto mínimo",
            "max": "number - Presupuesto máximo",
            "currency": "string - Moneda del presupuesto"
          },
          "accommodationPreference": "string - Tipo de alojamiento preferido",
          "transportPreference": "string - Medio de transporte preferido"
        },
        "notifications": {
          "email": "boolean - Notificaciones por email",
          "push": "boolean - Notificaciones push",
          "tripReminders": "boolean - Recordatorios de viajes",
          "promotions": "boolean - Promociones"
        },
        "createdTrips": "Array[ObjectId] - IDs de viajes creados",
        "stats": {
          "tripsCompleted": "number - Viajes completados",
          "countriesVisited": "Array[string] - Países visitados",
          "totalSpent": "number - Total gastado",
          "totalSaved": "number - Total ahorrado"
        },
        "deletionScheduled": {
          "isScheduled": "boolean - Eliminación programada",
          "scheduledDate": "Date - Fecha programada para eliminación",
          "requestedAt": "Date - Fecha de solicitud",
          "reason": "string - Razón de eliminación"
        },
        "isDeleted": "boolean - Marca de eliminación lógica",
        "deletedAt": "Date - Fecha de eliminación lógica",
        "deletedBy": "ObjectId - Usuario que realizó la eliminación",
        "createdAt": "Date - Fecha de creación",
        "updatedAt": "Date - Fecha de actualización"
      }
    },
    "Trip": {
      "description": "Modelo de viaje",
      "fields": {
        "id": "string - ID único del viaje",
        "userId": "ObjectId - ID del usuario propietario",
        "title": "string - Título del viaje",
        "destination": "string - Destino del viaje",
        "description": "string - Descripción (opcional)",
        "startDate": "Date - Fecha de inicio",
        "endDate": "Date - Fecha de fin",
        "partySize": "number - Número de personas (min: 1)",
        "status": "string - Estado (planned|ongoing|completed)",
        "itinerary": {
          "description": "Array - Lista de días del itinerario",
          "structure": {
            "dayNumber": "number - Número del día",
            "notes": "string - Notas del día",
            "activities": "Array - Actividades del día"
          }
        },
        "costs": {
          "description": "Array - Lista de costos",
          "structure": {
            "type": "string - Tipo de costo (lodging|transport|activity|other)",
            "label": "string - Etiqueta descriptiva",
            "currency": "string - Moneda (default: USD)",
            "amount": "number - Monto",
            "quantity": "number - Cantidad (default: 1)"
          }
        },
        "aiConversations": {
          "description": "Array - Conversaciones con IA",
          "structure": {
            "startedAt": "Date - Fecha de inicio",
            "messages": "Array - Mensajes de la conversación"
          }
        },
        "reports": {
          "description": "Array - Reportes generados",
          "structure": {
            "fileUrl": "string - URL del archivo",
            "format": "string - Formato (default: pdf)",
            "generatedAt": "Date - Fecha de generación"
          }
        },
        "totalBudget": "number - Presupuesto total calculado (virtual)",
        "isDeleted": "boolean - Marca de eliminación lógica",
        "deletedAt": "Date - Fecha de eliminación lógica",
        "deletedBy": "ObjectId - Usuario que realizó la eliminación",
        "createdAt": "Date - Fecha de creación",
        "updatedAt": "Date - Fecha de actualización"
      }
    }
  },
  "statusCodes": {
    "200": "OK - Solicitud exitosa",
    "201": "Created - Recurso creado exitosamente",
    "204": "No Content - Operación exitosa sin contenido de respuesta",
    "400": "Bad Request - Datos de entrada inválidos",
    "401": "Unauthorized - Token de autenticación inválido o ausente",
    "403": "Forbidden - No tiene permisos para esta operación",
    "404": "Not Found - Recurso no encontrado",
    "500": "Internal Server Error - Error interno del servidor"
  },
  "notes": {
    "authentication": "Todos los endpoints protegidos requieren un token JWT válido",
    "refreshToken": "Los tokens de acceso expiran en 1 hora",
    "adminRole": "Los endpoints marcados como 'adminOnly' requieren rol de administrador",
    "pagination": "Los endpoints que devuelven listas incluyen información de paginación",
    "softDelete": "El sistema usa eliminación lógica - los elementos se marcan como eliminados pero se conservan en la base de datos",
    "deletedFiltering": "Las consultas normales filtran automáticamente elementos eliminados",
    "adminManagement": "Los administradores pueden ver, restaurar y eliminar permanentemente elementos eliminados",
    "pdfGeneration": "Los PDFs se generan con Puppeteer y se almacenan en /reports",
    "pdfPreservation": "Con eliminación lógica, los PDFs se conservan para posible restauración",
    "aiIntegration": "Los endpoints de chat utilizan OpenAI GPT-4o-mini",
    "security": "Se validan permisos para asegurar que solo los propietarios accedan a sus recursos",
    "userPreferences": "Sistema completo de preferencias de viaje y notificaciones",
    "statistics": "Seguimiento de estadísticas de usuario (viajes, países, gastos)",
    "scheduledDeletion": "Los usuarios pueden programar eliminación de cuenta con 31 días de gracia"
  }
}
